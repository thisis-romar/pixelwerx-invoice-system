<!DOCTYPE html><!DOCTYPE html>

<html lang="en"><html lang="en">

<head><head>

  <meta charset="UTF-8">  <meta charset="UTF-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title><?= d.invoiceNumber ?> - PixelWerx Invoicing</title>  <title>PixelWerx Invoice</title>

  <style>  <style>

    @page {    * { margin:0; padding:0; box-sizing:border-box; }

      size: 8.5in 14in;    body { font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:#f8f5f2; padding:20px; }

      margin: 0.5in;    .invoice-container { max-width:800px; margin:0 auto; background:#fff; box-shadow:0 0 30px rgba(139,69,19,.1); }

    }    .header { background:linear-gradient(135deg,#3e2723 0%,#5d4037 100%); color:#fff; padding:40px; display:flex; align-items:center; justify-content:space-between; }

        .logo-img { height:80px; width:auto; display:block; filter:drop-shadow(0 2px 8px rgba(0,0,0,.3)); }

    * {    .invoice-header { display:flex; justify-content:space-between; padding:30px 40px; border-bottom:3px solid #ff5722; background:linear-gradient(to right,#fff3e0 0%,#ffffff 50%); }

      margin: 0;    .invoice-title { font-size:28px; color:#3e2723; font-weight:bold; }

      padding: 0;    .invoice-details { text-align:right; }

      box-sizing: border-box;    .invoice-number { font-size:18px; color:#5d4037; margin-bottom:5px; font-weight:600; }

    }    .invoice-date { font-size:14px; color:#8d6e63; }

        .parties { display:flex; justify-content:space-between; padding:30px 40px; background-color:#fafafa; }

    body {    .party { flex:1; }

      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;    .party-title { font-size:12px; text-transform:uppercase; color:#ff5722; font-weight:bold; margin-bottom:10px; letter-spacing:1.5px; }

      font-size: 10pt;    .party-info { font-size:14px; color:#424242; line-height:1.6; }

      line-height: 1.4;    .party-info strong { display:block; font-size:16px; margin-bottom:5px; color:#3e2723; }

      color: #2c3e50;    .event-details { padding:30px 40px; background-color:#fff; }

      background: #ffffff;    .event-title { font-size:18px; color:#3e2723; font-weight:bold; margin-bottom:15px; border-left:4px solid #ff5722; padding-left:15px; }

    }    .event-info { display:grid; grid-template-columns:repeat(2,1fr); gap:15px; font-size:14px; }

        .line-items { padding:30px 40px; }

    .page {    .section-title { font-size:18px; color:#3e2723; font-weight:bold; margin-bottom:20px; border-left:4px solid #ff5722; padding-left:15px; }

      width: 8.5in;    table { width:100%; border-collapse:collapse; margin-bottom:30px; }

      min-height: 14in;    thead { background:linear-gradient(135deg,#5d4037 0%,#4e342e 100%); color:#fff; }

      margin: 0 auto;    th { padding:15px; text-align:left; font-size:13px; text-transform:uppercase; letter-spacing:.5px; font-weight:600; }

      background: white;    th:last-child, td:last-child { text-align:right; }

      position: relative;    tbody tr { border-bottom:1px solid #efebe9; }

      page-break-after: always;    tbody tr:hover { background-color:#fff3e0; }

    }    tbody tr:nth-child(odd) { background-color:#fafafa; }

        td { padding:15px; font-size:14px; color:#424242; }

    .page:last-child {    .item-description { color:#757575; font-size:12px; display:block; margin-top:3px; }

      page-break-after: auto;    .subtotal-section { background:linear-gradient(to bottom,#fafafa 0%,#fff3e0 100%); padding:20px 40px; border-top:2px solid #efebe9; }

    }    .subtotal-row { display:flex; justify-content:space-between; padding:10px 0; font-size:14px; }

        .total-row { display:flex; justify-content:space-between; padding:15px 0; font-size:22px; border-top:3px solid #ff5722; margin-top:10px; }

    /* Header with Logo and Company Info */    .total-label { color:#3e2723; font-weight:bold; }

    .invoice-header {    .total-value { color:#ff5722; font-weight:bold; }

      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);    .notes { padding:30px 40px; background-color:#fff; }

      color: white;    .notes-content { font-size:13px; color:#616161; line-height:1.8; }

      padding: 30px;    .payment-badge { display:inline-block; background-color:#ff5722; color:#fff; padding:6px 16px; border-radius:20px; font-size:11px; font-weight:bold; text-transform:uppercase; letter-spacing:1px; margin:5px; box-shadow:0 2px 5px rgba(255,87,34,.3); }

      display: flex;    .footer { background:linear-gradient(135deg,#3e2723 0%,#5d4037 100%); color:#fff; padding:25px 40px; text-align:center; font-size:12px; }

      justify-content: space-between;    .accent-line { height:4px; background:linear-gradient(to right,#795548 0%,#f44336 50%,#ff9800 100%); margin:0; }

      align-items: center;    @page { size: A4; margin: 12mm; }

      border-radius: 8px 8px 0 0;    @media print { body { background:#fff; padding:0 } .invoice-container { box-shadow:none } tbody tr:hover { background:transparent } }

    }  </style>

    </head>

    .company-logo {<body>

      max-width: 200px;  <div class="invoice-container">

      max-height: 80px;    <div class="accent-line"></div>

      object-fit: contain;

    }    <div class="header">

          <img src="<?= d.seller.logoUrl ?>" alt="Logo" class="logo-img" onerror="this.style.display='none'">

    .company-info {    </div>

      text-align: right;

      flex: 1;    <div class="invoice-header">

      margin-left: 20px;      <div class="invoice-title">INVOICE</div>

    }      <div class="invoice-details">

            <div class="invoice-number">Invoice #: <?= d.invoiceNo ?></div>

    .company-name {        <div class="invoice-date">Date: <?= d.issueDate ?></div>

      font-size: 24pt;        <div class="invoice-date">Due: <?= d.dueText ?></div>

      font-weight: 700;      </div>

      margin-bottom: 5px;    </div>

      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);

    }    <div class="parties">

          <div class="party">

    .company-tagline {        <div class="party-title">From</div>

      font-size: 10pt;        <div class="party-info">

      opacity: 0.9;          <strong><?= d.seller.name ?></strong>

      font-style: italic;          <?= d.seller.addressHtml ?>

    }          <br>Email: <?= d.seller.email ?><br>Phone: <?= d.seller.phone ?>

              <br>HST#: <?= d.seller.hstNumber ?>

    .company-hst {        </div>

      font-size: 9pt;      </div>

      opacity: 0.85;      <div class="party">

      margin-top: 8px;        <div class="party-title">Bill To</div>

      font-weight: 600;        <div class="party-info">

    }          <strong><?= d.client.legalName ?></strong>

              Attn: <?= d.client.attention ?><br>

    /* Invoice Title Section */          <?= d.client.addressHtml ?><br>

    .invoice-title-section {          <?= d.client.email ?><br><?= d.client.phone ?>

      background: linear-gradient(to right, #ecf0f1 0%, #ffffff 100%);        </div>

      padding: 20px 30px;      </div>

      border-bottom: 3px solid #3498db;    </div>

      display: flex;

      justify-content: space-between;    <div class="event-details">

      align-items: center;      <div class="event-title">Event Details</div>

    }      <div class="event-info">

            <div>Venue: <?= d.event.venue ?></div>

    .invoice-title {        <div>Location: <?= d.event.location ?></div>

      font-size: 28pt;        <div>Load-In: <?= d.event.loadIn ?></div>

      color: #2c3e50;        <div>Event Date: <?= d.event.start ?></div>

      font-weight: 700;        <div>Load-Out: <?= d.event.loadOut ?></div>

    }        <div>Duration: <?= d.event.durationText ?></div>

          </div>

    .invoice-meta {    </div>

      text-align: right;

    }    <div class="line-items">

          <div class="section-title">Equipment & Services</div>

    .invoice-number {      <table>

      font-size: 16pt;        <thead>

      color: #34495e;          <tr><th>Description</th><th style="text-align:center;">Qty</th><th style="text-align:right;">Rate</th><th style="text-align:right;">Amount</th></tr>

      font-weight: 600;        </thead>

      margin-bottom: 5px;        <tbody>

    }          <? for (let row of d.items) { ?>

                <tr>

    .invoice-date {              <td>

      font-size: 10pt;                <strong><?= row.title ?></strong>

      color: #7f8c8d;                <? if (row.description) { ?><span class="item-description"><?= row.description ?></span><? } ?>

    }              </td>

                  <td style="text-align:center;"><?= row.qty ?></td>

    /* Parties Section */              <td style="text-align:right;"><?= row.rateFormatted ?></td>

    .parties {              <td style="text-align:right;"><?= row.amountFormatted ?></td>

      display: flex;            </tr>

      justify-content: space-between;          <? } ?>

      padding: 25px 30px;        </tbody>

      gap: 40px;      </table>

      background-color: #f8f9fa;    </div>

    }

        <div class="subtotal-section">

    .party {      <div class="subtotal-row"><span>Subtotal:</span><span><?= d.subtotalFormatted ?></span></div>

      flex: 1;      <div class="subtotal-row"><span><?= d.taxLabel ?>:</span><span><?= d.taxFormatted ?></span></div>

    }      <div class="total-row"><span class="total-label">Total Amount Due:</span><span class="total-value"><?= d.totalFormatted ?> <?= d.currency ?></span></div>

        </div>

    .party-title {

      font-size: 11pt;    <div class="notes">

      text-transform: uppercase;      <div class="section-title">Terms & Conditions</div>

      color: #3498db;      <div class="notes-content">

      font-weight: 700;        <ul><? for (let t of d.terms) { ?><li><?= t ?></li><? } ?></ul>

      margin-bottom: 12px;        <? if (d.paymentMethods && d.paymentMethods.length) { ?>

      letter-spacing: 1px;          <p style="margin-top:20px;"><strong>Accepted Payment Methods:</strong>

      border-bottom: 2px solid #3498db;            <? for (let m of d.paymentMethods) { ?><span class="payment-badge"><?= m ?></span><? } ?>

      padding-bottom: 5px;          </p>

    }        <? } ?>

          </div>

    .party-name {    </div>

      font-size: 13pt;

      font-weight: 600;    <div class="footer">

      color: #2c3e50;      Thank you for choosing PixelWerx LED Video Wall Solutions

      margin-bottom: 8px;      <div style="margin-top:8px;font-size:11px;opacity:.8;">

    }        Questions? <a href="mailto:<?= d.seller.email ?>" style="color:#ffab91;"><?= d.seller.email ?></a> • Phone: <?= d.seller.phone ?>

          </div>

    .party-details {    </div>

      font-size: 9pt;

      color: #34495e;    <div class="accent-line"></div>

      line-height: 1.6;  </div>

    }</body>

    </html>

    /* Line Items Table */
    .line-items {
      margin: 25px 30px;
    }
    
    .items-title {
      font-size: 14pt;
      color: #2c3e50;
      font-weight: 700;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #e74c3c;
    }
    
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    
    thead {
      background: linear-gradient(135deg, #34495e 0%, #2c3e50 100%);
      color: white;
    }
    
    th {
      padding: 12px 10px;
      text-align: left;
      font-size: 10pt;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    th.text-right {
      text-align: right;
    }
    
    tbody tr {
      border-bottom: 1px solid #ecf0f1;
    }
    
    tbody tr:hover {
      background-color: #f8f9fa;
    }
    
    td {
      padding: 12px 10px;
      font-size: 9pt;
      color: #2c3e50;
    }
    
    td.text-right {
      text-align: right;
      font-weight: 600;
    }
    
    .item-description {
      color: #7f8c8d;
      font-size: 8.5pt;
      margin-top: 4px;
      line-height: 1.4;
    }
    
    /* Color Badges */
    .badges {
      display: flex;
      gap: 5px;
      margin-top: 5px;
      flex-wrap: wrap;
    }
    
    .badge {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      border: 2px solid white;
      box-shadow: 0 2px 4px rgba(0,0,0,0.2);
      display: inline-block;
    }
    
    .badge.brown { background-color: #8B4513; }
    .badge.red { background-color: #DC143C; }
    .badge.orange { background-color: #FF8C00; }
    .badge.yellow { background-color: #FFD700; }
    .badge.green { background-color: #228B22; }
    .badge.blue { background-color: #4169E1; }
    .badge.purple { background-color: #8B008B; }
    .badge.pink { background-color: #FF1493; }
    .badge.black { background-color: #000000; }
    .badge.white { background-color: #FFFFFF; border-color: #ccc; }
    .badge.gray { background-color: #808080; }
    
    /* Event Details */
    .event-details {
      background-color: #ecf0f1;
      padding: 20px;
      border-radius: 8px;
      margin: 25px 30px;
    }
    
    .event-title {
      font-size: 12pt;
      color: #2c3e50;
      font-weight: 700;
      margin-bottom: 15px;
      padding-bottom: 8px;
      border-bottom: 2px solid #3498db;
    }
    
    .event-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 15px 30px;
    }
    
    .event-field {
      display: flex;
      flex-direction: column;
    }
    
    .event-field-label {
      font-size: 8.5pt;
      color: #7f8c8d;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      margin-bottom: 4px;
      font-weight: 600;
    }
    
    .event-field-value {
      font-size: 10pt;
      color: #2c3e50;
      font-weight: 600;
    }
    
    /* Totals Section */
    .totals {
      margin: 25px 30px;
      display: flex;
      justify-content: flex-end;
    }
    
    .totals-table {
      width: 350px;
      background-color: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    }
    
    .totals-table table {
      width: 100%;
      margin-bottom: 0;
    }
    
    .totals-table tr {
      border: none;
    }
    
    .totals-table td {
      padding: 8px 0;
      font-size: 10pt;
    }
    
    .totals-table .total-row {
      border-top: 2px solid #34495e;
      font-size: 13pt;
      font-weight: 700;
      color: #2c3e50;
    }
    
    .totals-table .total-row td {
      padding-top: 15px;
    }
    
    /* Payment Info */
    .payment-info {
      margin: 25px 30px;
      padding: 20px;
      background: linear-gradient(to right, #e8f5e9 0%, #f1f8e9 100%);
      border-left: 5px solid #27ae60;
      border-radius: 8px;
    }
    
    .payment-title {
      font-size: 12pt;
      color: #27ae60;
      font-weight: 700;
      margin-bottom: 12px;
    }
    
    .payment-methods {
      display: flex;
      gap: 15px;
      flex-wrap: wrap;
      margin-bottom: 15px;
    }
    
    .payment-badge {
      padding: 8px 16px;
      background-color: white;
      border: 2px solid #27ae60;
      border-radius: 20px;
      font-size: 9pt;
      font-weight: 600;
      color: #27ae60;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    
    .payment-details {
      font-size: 9pt;
      color: #2c3e50;
      line-height: 1.6;
    }
    
    /* Terms and Notes */
    .terms-notes {
      margin: 25px 30px;
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }
    
    .terms, .notes {
      padding: 15px;
      background-color: #fff3cd;
      border-left: 4px solid #f39c12;
      border-radius: 4px;
    }
    
    .section-title {
      font-size: 11pt;
      color: #e67e22;
      font-weight: 700;
      margin-bottom: 10px;
    }
    
    .section-content {
      font-size: 9pt;
      color: #2c3e50;
      line-height: 1.6;
    }
    
    /* Footer */
    .invoice-footer {
      background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
      color: white;
      padding: 20px 30px;
      text-align: center;
      border-radius: 0 0 8px 8px;
      margin-top: 30px;
    }
    
    .footer-content {
      font-size: 9pt;
      line-height: 1.8;
    }
    
    .footer-hst {
      font-weight: 600;
      margin-top: 8px;
    }
    
    /* Page Numbers */
    .page-number {
      position: absolute;
      bottom: 20px;
      right: 30px;
      font-size: 9pt;
      color: #7f8c8d;
    }
  </style>
</head>
<body>
  <div class="page">
    <!-- Header -->
    <div class="invoice-header">
      <? if (d.seller.logoUrl) { ?>
        <img src="<?= d.seller.logoUrl ?>" alt="<?= d.seller.name ?>" class="company-logo" 
             onerror="this.style.display='none'; this.nextElementSibling.style.display='block';">
        <div class="company-name" style="display:none;"><?= d.seller.name ?></div>
      <? } else { ?>
        <div class="company-name"><?= d.seller.name ?></div>
      <? } ?>
      
      <div class="company-info">
        <div class="company-tagline">Professional Event Production & Media Services</div>
        <? if (d.seller.hstNumber) { ?>
          <div class="company-hst">HST# <?= d.seller.hstNumber ?></div>
        <? } ?>
      </div>
    </div>
    
    <!-- Invoice Title Section -->
    <div class="invoice-title-section">
      <div class="invoice-title">INVOICE</div>
      <div class="invoice-meta">
        <div class="invoice-number"><?= d.invoiceNumber ?></div>
        <div class="invoice-date">Date: <?= d.invoiceDate ?></div>
        <? if (d.dueDate) { ?>
          <div class="invoice-date">Due: <?= d.dueDate ?></div>
        <? } ?>
      </div>
    </div>
    
    <!-- Parties -->
    <div class="parties">
      <div class="party">
        <div class="party-title">From</div>
        <div class="party-name"><?= d.seller.name ?></div>
        <div class="party-details">
          <? if (d.seller.address) { ?><?= d.seller.address ?><br><? } ?>
          <? if (d.seller.email) { ?>Email: <?= d.seller.email ?><br><? } ?>
          <? if (d.seller.phone) { ?>Phone: <?= d.seller.phone ?><br><? } ?>
        </div>
      </div>
      
      <div class="party">
        <div class="party-title">Bill To</div>
        <div class="party-name"><?= d.buyer.name ?></div>
        <div class="party-details">
          <? if (d.buyer.address) { ?><?= d.buyer.address ?><br><? } ?>
          <? if (d.buyer.email) { ?>Email: <?= d.buyer.email ?><br><? } ?>
          <? if (d.buyer.phone) { ?>Phone: <?= d.buyer.phone ?><br><? } ?>
        </div>
      </div>
    </div>
    
    <!-- Event Details -->
    <? if (d.eventName || d.eventDate || d.eventLocation || d.eventDescription) { ?>
    <div class="event-details">
      <div class="event-title">Event Information</div>
      <div class="event-grid">
        <? if (d.eventName) { ?>
          <div class="event-field">
            <div class="event-field-label">Event Name</div>
            <div class="event-field-value"><?= d.eventName ?></div>
          </div>
        <? } ?>
        
        <? if (d.eventDate) { ?>
          <div class="event-field">
            <div class="event-field-label">Event Date</div>
            <div class="event-field-value"><?= d.eventDate ?></div>
          </div>
        <? } ?>
        
        <? if (d.eventLocation) { ?>
          <div class="event-field">
            <div class="event-field-label">Location</div>
            <div class="event-field-value"><?= d.eventLocation ?></div>
          </div>
        <? } ?>
        
        <? if (d.eventDescription) { ?>
          <div class="event-field" style="grid-column: 1 / -1;">
            <div class="event-field-label">Description</div>
            <div class="event-field-value"><?= d.eventDescription ?></div>
          </div>
        <? } ?>
      </div>
    </div>
    <? } ?>
    
    <!-- Line Items -->
    <div class="line-items">
      <div class="items-title">Services & Equipment</div>
      <table>
        <thead>
          <tr>
            <th style="width: 50%;">Description</th>
            <th style="width: 15%;" class="text-right">Quantity</th>
            <th style="width: 15%;" class="text-right">Unit Price</th>
            <th style="width: 20%;" class="text-right">Amount</th>
          </tr>
        </thead>
        <tbody>
          <? for (let i = 0; i < d.items.length; i++) { 
               let row = d.items[i]; ?>
            <tr>
              <td>
                <strong><?= row.description ?></strong>
                <? if (row.detailedDescription) { ?>
                  <div class="item-description"><?= row.detailedDescription ?></div>
                <? } ?>
                <? if (row.badges && row.badges.length > 0) { ?>
                  <div class="badges">
                    <? for (let badge of row.badges) { ?>
                      <span class="badge <?= badge.toLowerCase() ?>" 
                            title="<?= badge ?> equipment"></span>
                    <? } ?>
                  </div>
                <? } ?>
              </td>
              <td class="text-right"><?= row.quantity ?></td>
              <td class="text-right"><?= row.unitPrice ?></td>
              <td class="text-right"><?= row.amount ?></td>
            </tr>
          <? } ?>
        </tbody>
      </table>
    </div>
    
    <!-- Totals -->
    <div class="totals">
      <div class="totals-table">
        <table>
          <tr>
            <td>Subtotal:</td>
            <td class="text-right"><?= d.subtotal ?></td>
          </tr>
          
          <? if (d.discount && d.discount !== '$0.00') { ?>
            <tr>
              <td>Discount:</td>
              <td class="text-right"><?= d.discount ?></td>
            </tr>
          <? } ?>
          
          <? if (d.taxLabel && d.taxAmount && d.taxAmount !== '$0.00') { ?>
            <tr>
              <td><?= d.taxLabel ?>:</td>
              <td class="text-right"><?= d.taxAmount ?></td>
            </tr>
          <? } ?>
          
          <tr class="total-row">
            <td>TOTAL <?= d.currency || 'CAD' ?>:</td>
            <td class="text-right"><?= d.total ?></td>
          </tr>
          
          <? if (d.amountPaid && d.amountPaid !== '$0.00') { ?>
            <tr>
              <td>Amount Paid:</td>
              <td class="text-right"><?= d.amountPaid ?></td>
            </tr>
            <tr class="total-row">
              <td>Balance Due:</td>
              <td class="text-right"><?= d.balanceDue ?></td>
            </tr>
          <? } ?>
        </table>
      </div>
    </div>
    
    <!-- Payment Information -->
    <? if (d.paymentMethods && d.paymentMethods.length > 0) { ?>
    <div class="payment-info">
      <div class="payment-title">💳 Payment Methods Accepted</div>
      <div class="payment-methods">
        <? for (let method of d.paymentMethods) { ?>
          <span class="payment-badge"><?= method ?></span>
        <? } ?>
      </div>
      <? if (d.paymentInstructions) { ?>
        <div class="payment-details"><?= d.paymentInstructions ?></div>
      <? } ?>
    </div>
    <? } ?>
    
    <!-- Terms and Notes -->
    <div class="terms-notes">
      <? if (d.terms && d.terms.length > 0) { ?>
        <div class="terms">
          <div class="section-title">Terms & Conditions</div>
          <div class="section-content">
            <? for (let term of d.terms) { ?>
              • <?= term ?><br>
            <? } ?>
          </div>
        </div>
      <? } ?>
      
      <? if (d.notes) { ?>
        <div class="notes">
          <div class="section-title">Notes</div>
          <div class="section-content"><?= d.notes ?></div>
        </div>
      <? } ?>
    </div>
    
    <!-- Footer -->
    <div class="invoice-footer">
      <div class="footer-content">
        Thank you for your business!<br>
        <? if (d.seller.email) { ?>
          Questions? Contact us at <?= d.seller.email ?>
          <? if (d.seller.phone) { ?> or <?= d.seller.phone ?><? } ?>
          <br>
        <? } ?>
        <? if (d.seller.hstNumber) { ?>
          <div class="footer-hst">HST Registration: <?= d.seller.hstNumber ?></div>
        <? } ?>
      </div>
    </div>
    
    <div class="page-number">Page 1 of 1</div>
  </div>
</body>
</html>
